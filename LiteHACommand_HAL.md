# 指令集

适用于所有设备，换句话说，即所有设备都必须有这些功能。

## 网关

* 搜索网络所有设备

  | 搜索网络所有设备   |            |             |
  | ---------- | ---------- | ----------- |
  | **操作码**    | 0x0001     |             |
  | **目标子网ID** | 要接收数据的子网ID | 1字节，1-254   |
  | **目标设备ID** | 要接收数据的设备ID | 2字节，1-65534 |
  | **附加消息**   |            |             |
  | **附加消息长度** | 0字节        |             |

  回复：

  | 搜索网络所有设备   | ID，类型，地理分区，固件版本 |                   |
  | ---------- | --------------- | ----------------- |
  | **操作码**    | 0x0002          |                   |
  | **目标子网ID** | 要接收数据的子网ID      | 1字节，1-254         |
  | **目标设备ID** | 要接收数据的设备ID      | 2字节，1-65534       |
  | **附加消息**   |                 |                   |
  | **附加消息长度** | 0字节             |                   |
  | *附加消息序号*   | *附加名称*          | *附加值*             |
  | 0          | 状态位             | 1字节，0xc5成功，0xc8失败 |
  | 1~4        | 地理分区            | 4字节，地理分区内容        |
  | 5~8        | 固件版本号           | 4字节，固件版本号         |

* 添加控制网关的设备白名单

    | 添加白名单      |            |                                          |
    | ---------- | ---------- | ---------------------------------------- |
    | **操作码**    | 0x0003     |                                          |
    | **目标子网ID** | 要接收数据的子网ID | 1字节，1-254                                |
    | **目标设备ID** | 要接收数据的设备ID | 2字节，1-65534                              |
    | **附加消息**   |            |                                          |
    | **附加消息长度** | 0字节        |                                          |
    | *附加消息序号*   | *附加名称*     | *附加值*                                    |
    | 0          | 设备类型       | 1字节，1安卓手机，2苹果手机，3安装平板，4苹果平板              |
    | 1~33       | 设备唯一标识     | 32字节，设备唯一标识的前32个字节，用于确定设备的唯一性，网关用于绑定设备到白名单 |
    | 34         | 名称等级       | 暂时不用，取0                                  |
    | 35         | 权限         | 暂时不用，取0                                  |

    回复：

    | 添加白名单      | 回复登录是否成功   |                                          |
    | ---------- | ---------- | ---------------------------------------- |
    | **操作码**    | 0x0004     |                                          |
    | **目标子网ID** | 要接收数据的子网ID | 1字节，1-254                                |
    | **目标设备ID** | 要接收数据的设备ID | 2字节，1-65534                              |
    | **附加消息**   |            |                                          |
    | **附加消息长度** | 0字节        |                                          |
    | *附加消息序号*   | *附加名称*     | *附加值*                                    |
    | 0          | 状态位        | 1字节，0xc5成功，0xc8失败                        |
    | 1          | 状态详情       | 1字节，<br />0:成功登录；<br />1:已经存在该设备；<br />2:唯一标识不合法；<br />3:其他未知错误； |

* 删除控制网关的设备白名单

* 设置网关实时时间

* 刷新设备固件更新列表

* 设置场景

    场景设置，每增加或减少一个设备动作，都是直接操作设备，成功后才保存到数据库，不成功就进行提示，设置完所有操作后，点击保存，就在网关生成一个场景名称，场景ID，场景地理分区。

    ​

    ​

* 读取场景

    读取场景，读取场景是读取网关数据库保存的场景的内容，包括场景ID，场景名称和地理分区。

    ​

* 刷新场景内容（耗时长，向设备读取内容）

    重新读取每个设备的场景耗时严重。

    ​

* 手机唯一标识，触发可控制使能30min，刷新客户端可控制时间

    ​

## 所有设备

* 读取版本号
* 读取设备唯一标识
* 修改设备唯一标识
* 读取地理分区
* 修改地理分区
* 读取设备名称
* 修改设备名称
* 读取设备ID
* 修改设备ID
* 还原出厂设置
* 读取设备温度
* 灯光控制
* 场景控制
* ​

